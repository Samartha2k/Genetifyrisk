<!DOCTYPE html>
<html>
<head>
  <title>Genetify Risk</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Inter', sans-serif;
      background: #f0f4f8;
      color: #1a202c;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
      overflow-x: hidden;
    }

    .container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 10px 45px rgba(97, 119, 255, 0.15);
      width: 100%;
      max-width: 460px;
      padding: 40px 48px;
      text-align: center;
      transition: box-shadow 0.35s ease;
      position: relative;
      z-index: 1;
    }
    .container:hover {
      box-shadow: 0 20px 60px rgba(97, 119, 255, 0.35);
    }

    .logo {
      width: 100px;
      height: 100px;
      fill: #5a5adf;
      margin: 0 auto 10px;
      transition: transform 0.3s ease;
      cursor: pointer;
    }
    .logo:hover {
      transform: rotate(15deg) scale(1.1);
    }

    h1 {
      font-weight: 700;
      font-size: 2.5rem;
      margin-top: 0;
      margin-bottom: 14px; /* smaller margin for tagline */
      color: #2d3748;
      letter-spacing: 0.08em;
    }

    .tagline {
      font-size: 1rem;
      letter-spacing: 0.05em;
      color: #6b7280;
      margin-bottom: 36px;
      font-weight: 600;
      font-style: italic;
    }

    label {
      display: block;
      font-weight: 600;
      font-size: 1rem;
      color: #4a5568;
      text-align: left;
      margin-bottom: 10px;
      transition: color 0.3s ease;
    }

    input[type=text], select, input[type=number] {
      width: 100%;
      padding: 14px 16px;
      border-radius: 14px;
      border: 1.8px solid #cbd5e0;
      font-size: 1.05rem;
      color: #2d3748;
      background: #f7fafc;
      margin-bottom: 28px;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
      font-weight: 400;
    }

    input[type=text]:focus, select:focus, input[type=number]:focus {
      border-color: #667eea;
      box-shadow: 0 6px 18px rgba(102, 126, 234, 0.4);
      outline: none;
      background: #fff;
    }

    button {
      width: 100%;
      padding: 16px 0;
      font-weight: 700;
      font-size: 1.25rem;
      border-radius: 16px;
      border: none;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      cursor: pointer;
      box-shadow: 0 8px 24px rgba(118, 75, 162, 0.45);
      transition: background 0.3s ease, box-shadow 0.3s ease, transform 0.15s ease;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      letter-spacing: 2px;
      user-select: none;
    }
    button:hover {
      background: linear-gradient(135deg, #5a5adf 0%, #65388f 100%);
      box-shadow: 0 12px 40px rgba(90, 90, 223, 0.7);
      transform: translateY(-3px);
    }
    button:active {
      transform: translateY(1px);
      box-shadow: 0 6px 18px rgba(90, 90, 223, 0.5);
    }

    #result {
      margin-top: 40px;
      font-weight: 700;
      font-size: 1.7rem;
      color: #5a5adf;
      min-height: 2.5em;
      transition: color 0.3s ease;
      user-select: all;
    }

    /* Popup overlay */
    #popup-overlay {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      backdrop-filter: blur(6px);
      background: rgba(0, 0, 0, 0.3);
      opacity: 0;
      transition: opacity 0.35s ease;
      z-index: 9998;
    }
    #popup-overlay.show {
      display: block;
      opacity: 1;
    }

    /* Popup */
    #popup {
      position: fixed;
      top: 50%; left: 50%;
      transform: translate(-50%, -60%);
      background: #5a5adf;
      color: white;
      font-size: 1.6rem;
      font-weight: 700;
      padding: 20px 36px;
      border-radius: 14px;
      box-shadow: 0 12px 40px rgba(90, 90, 223, 0.9);
      user-select: all;
      z-index: 9999;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.35s ease, transform 0.45s cubic-bezier(0.4, 0, 0.2, 1);
      min-width: 270px;
      text-align: center;
      max-width: 90vw;
    }
    #popup.show {
      opacity: 1;
      pointer-events: auto;
      transform: translate(-50%, -50%);
    }

    /* Close button */
    #popup-close {
      position: absolute;
      top: 10px; right: 14px;
      width: 25px; height: 25px;
      background: transparent;
      border: none;
      cursor: pointer;
      opacity: 0.7;
      transition: opacity 0.2s ease;
      z-index: 10000;
    }
    #popup-close:hover {
      opacity: 1;
    }
    #popup-close:before, #popup-close:after {
      content: '';
      position: absolute;
      left: 11px;
      top: 4px;
      width: 3px;
      height: 18px;
      background-color: white;
      border-radius: 3px;
    }
    #popup-close:before {
      transform: rotate(45deg);
    }
    #popup-close:after {
      transform: rotate(-45deg);
    }
  </style>
</head>
<body>
  <div class="container" role="main" aria-labelledby="main-title">
    <svg class="logo" viewBox="0 -8 72 72" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
      <title>Genetify Risk Logo</title>
      <path d="M47.71,24.61a15.61,15.61,0,0,0,2.44.19,11.08,11.08,0,0,0,8-3.11l1.19-1.19a2,2,0,1,0-2.88-2.88l-.29.29L46.09,7.82l.29-.28A2,2,0,0,0,43.5,4.66L42.31,5.85a11,11,0,0,0-3.11,8,16.59,16.59,0,0,0,2.14,8,12.82,12.82,0,0,1,1.62,6,7.73,7.73,0,0,1-1.12,4.14L32,22.16a6.54,6.54,0,0,1,2.1-.88l7.8,7.8a7.12,7.12,0,0,0,.09-1.17,10.69,10.69,0,0,0-.36-2.71l-4.07-4.07a12.88,12.88,0,0,1,2.61.63,18.21,18.21,0,0,1-1.6-4.6A15.61,15.61,0,0,0,36.08,17,10.65,10.65,0,0,0,25,28.08a16.59,16.59,0,0,0,2.14,8,12.82,12.82,0,0,1,1.62,6,7.73,7.73,0,0,1-1.12,4.14l-9.89-9.89a6.59,6.59,0,0,1,2.11-.88l7.79,7.79a6.93,6.93,0,0,0,.09-1.16,10.69,10.69,0,0,0-.36-2.71l-4.06-4.06a12.92,12.92,0,0,1,2.6.62,18.24,18.24,0,0,1-1.61-4.6,15.4,15.4,0,0,0-2.43-.19,11,11,0,0,0-8,3.11L12.66,35.5a2,2,0,0,0,2.88,2.88l.29-.29L25.91,48.17l-.29.29a2,2,0,1,0,2.88,2.88l1.19-1.19a11,11,0,0,0,3.11-8,16.59,16.59,0,0,0-2.14-8,12.82,12.82,0,0,1-1.62-6A7.73,7.73,0,0,1,30.16,24l9.89,9.89a6.54,6.54,0,0,1-2.1.88l-7.8-7.8a7.12,7.12,0,0,0-.09,1.17,10.56,10.56,0,0,0,.36,2.7l4.07,4.08a13.58,13.58,0,0,1-2.61-.63,18.21,18.21,0,0,1,1.6,4.6,15.61,15.61,0,0,0,2.44.19A10.65,10.65,0,0,0,47,27.92a16.59,16.59,0,0,0-2.14-8,12.82,12.82,0,0,1-1.62-6,7.73,7.73,0,0,1,1.12-4.14l9.89,9.89a6.82,6.82,0,0,1-2.11.88l-7.8-7.8a8.31,8.31,0,0,0-.08,1.17,10.69,10.69,0,0,0,.36,2.71l4.06,4.06a12.16,12.16,0,0,1-2.6-.63A18.28,18.28,0,0,1,47.71,24.61Z" />
    </svg>

    <h1 id="main-title">Genetify Risk</h1>
    <div class="tagline">Genetic Disorder Risk Calculator</div>

    <form id="calcForm" aria-describedby="result">
      <label for="prevalence">Disease Prevalence:</label>
      <input id="prevalence" type="text" name="prevalence" placeholder="e.g. 1/5000 or 0.0002" required autocomplete="off">

      <label for="inheritance">Inheritance Type:</label>
      <select id="inheritance" name="inheritance" required>
        <option value="recessive">Recessive</option>
        <option value="dominant">Dominant</option>
      </select>

      <label for="x">Generations to Common Ancestor:</label>
      <input id="x" type="number" name="x" placeholder="e.g. 5" min="0" required autocomplete="off">

      <button type="submit">Calculate</button>
    </form>

    <div id="result" role="region" aria-live="polite" aria-atomic="true"></div>
  </div>

  <div id="popup-overlay"></div>
  <div id="popup" role="alert" aria-live="assertive">
    <button id="popup-close" aria-label="Close popup"></button>
    <div id="popup-text"></div>
  </div>

  <script>
    function parsePrevalence(value) {
      if (value.includes('/')) {
        const [num, denom] = value.split('/');
        return parseFloat(num) / parseFloat(denom);
      }
      return parseFloat(value);
    }

    const popup = document.getElementById('popup');
    const overlay = document.getElementById('popup-overlay');
    const popupText = document.getElementById('popup-text');
    const popupClose = document.getElementById('popup-close');

    function showPopup(text) {
      popupText.textContent = text;
      overlay.classList.add('show');
      popup.classList.add('show');
    }

    function hidePopup() {
      popup.classList.remove('show');
      overlay.classList.remove('show');
    }

    popupClose.onclick = hidePopup;
    overlay.onclick = hidePopup;

    document.getElementById('calcForm').addEventListener('submit', function(event) {
      event.preventDefault();

      const prevalence = this.prevalence.value.trim();
      const inheritance = this.inheritance.value;
      const x = parseFloat(this.x.value);

      if (isNaN(parsePrevalence(prevalence))) {
        alert('Please enter a valid prevalence');
        return;
      }
      if (isNaN(x) || x < 0) {
        alert('Please enter a valid non-negative number for generations');
        return;
      }

      let risk;
      const q = Math.sqrt(parsePrevalence(prevalence));
      const F = Math.pow(0.5, 2 * x);

      if (inheritance === 'recessive') {
        risk = F * q + (1 - F) * (q ** 2);
      } else if (inheritance === 'dominant') {
        risk = parsePrevalence(prevalence);
      } else {
        risk = 0;
      }

      const percentRisk = risk * 100;
      showPopup(`Estimated risk: ${percentRisk.toFixed(4)}%`);
    });
  </script>
</body>
</html>
